--- 
before_install: 
  - "sudo apt-get install -y xmlstarlet"
  - "SPOON_MAVEN_PLUGIN_VERSION=`xmlstarlet sel -t -v '/_:project/_:version' pom.xml`"
git: 
  depth: 1
install: true
jdk: 
  - openjdk8
  - openjdk11
jobs: 
  include: ~
  script: 
    - "cd src/test/projects/processors"
    - "mvn install -DskipTests"
    - "cd ../../../.."
    - "mvn install"
  stage: "run junit"
language: java
env:
  - projectName=custom-configuration
  - projectName=hello-world
  - projectName=hello-world-commented
  - projectName=hello-world-config-exception
  - projectName=hello-world-config-exception-ignored
  - projectName=hello-world-exception
  - projectName=hello-world-inputs
  - projectName=hello-world-no-sources
  - projectName=hello-world-spoon-xml
  - projectName=hello-world-with-comments-disabled
  - projectName=hello-world-with-imports
  - projectName=hello-world-with-processor
  - projectName=hello-world-with-properties
  - projectName=javacc-generate
script: 
  - "cd src/test/projects/processors"
  - "mvn install -DskipTests"
  - "cd ../../../.."
  - "mvn install -DskipTests"
  - "cd src/test/projects/"
  - cd $projectName
  - "xmlstarlet edit -L --update '/_:project/_:build/_:plugins/_:plugin/_:version' --value $SPOON_MAVEN_PLUGIN_VERSION pom.xml"
  - "mvn package"
  - "mvn clean"
  - "cd ../../../.."
sudo: required
